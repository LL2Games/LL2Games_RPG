ì˜¤ì¼€ì´ ğŸ‘
ì§€ê¸ˆ ìƒíƒœ ë”± **â€œMMORPG ì„œë²„ì—ì„œ ìŠ¤íƒ¯ ì‹œìŠ¤í…œ ë¼ˆëŒ€ ì¡ê¸°â€** ë“¤ì–´ê°€ê¸° ì¢‹ì€ ì‹œì ì´ì•¼.
ì•„ë˜ëŠ” **ì‹¤ë¬´ ê¸°ì¤€ + ë„¤ í”„ë¡œì íŠ¸ êµ¬ì¡°(ChannelD)ì— ë”± ë§ì¶˜ ê°€ì´ë“œ**ë¡œ ì •ë¦¬í•´ì¤„ê²Œ.

---

# 1ï¸âƒ£ êµ¬í˜„ ìˆœì„œ ê°€ì´ë“œ (ì¤‘ìš”)

> **ìˆœì„œ í‹€ë¦¬ë©´ ì¤‘ê°„ì— ì„¤ê³„ ê°ˆì•„ì—ê²Œ ë¨**
> â†’ â€œë°ì´í„° êµ¬ì¡° â†’ ë„ë©”ì¸ ë¡œì§ â†’ í•¸ë“¤ëŸ¬(Op) â†’ íŒ¨í‚·â€ ìˆœì„œ ê³ ì •

---

## âœ… STEP 1. ëŠ¥ë ¥ì¹˜ ë„ë©”ì¸ ì •ì˜ (ê°€ì¥ ë¨¼ì €)

### 1-1. ëŠ¥ë ¥ì¹˜ ë¶„ë¥˜ë¶€í„° ì •ë¦¬

ëŠ¥ë ¥ì¹˜ë¥¼ **ì„±ê²©ë³„ë¡œ ë¶„ë¦¬**í•´ì•¼ ë‚˜ì¤‘ì— ì¥ë¹„ / ë²„í”„ / íŒ¨ì‹œë¸Œ ë¶™ì´ê¸° ì‰¬ì›Œì§

```text
[Base Stat]   : STR / DEX / INT / LUK
[Derived Stat]: MaxHP / MaxMP / ATK / MoveSpeed / Jump
[Runtime Stat]: CurrentHP / CurrentMP
```

ğŸ‘‰ **ì¤‘ìš” í¬ì¸íŠ¸**

* `ì´ê³µê²©ë ¥`ì€ **DBì— ì €ì¥ âŒ**
* `HP / MP`ëŠ”

  * Max / Current ë¶„ë¦¬
* ì´ë™ì†ë„, ì í”„ë ¥ì€ ê¸°ë³¸ê°’ + ë³´ì •ê°’ êµ¬ì¡° ì¶”ì²œ

---

### 1-2. C++ êµ¬ì¡°ì²´ (ë„ë©”ì¸ ëª¨ë¸)

ğŸ“ `core/stat/CharacterStat.h` (ì‹ ê·œ)

```cpp
struct BaseStat {
    int str;
    int dex;
    int intel;
    int luk;
};

struct DerivedStat {
    int maxHp;
    int maxMp;
    int attack;
    int moveSpeed;
    int jump;
};

struct RuntimeStat {
    int currentHp;
    int currentMp;
};
```

ğŸ‘‰ ì´ê±´ **DBë‘ 1:1 ëŒ€ì‘ ì•„ë‹˜**
ğŸ‘‰ â€œê²Œì„ ê·œì¹™ì˜ ì¤‘ì‹¬ ëª¨ë¸â€ì„

---

## âœ… STEP 2. DB í…Œì´ë¸” ì„¤ê³„ (char_id ê¸°ì¤€)

### 2-1. DB í…Œì´ë¸” ë¶„ë¦¬ (GOOD íŒë‹¨ ğŸ‘)

```sql
CREATE TABLE character_stat (
    char_id     BIGINT PRIMARY KEY,
    str         INT NOT NULL,
    dex         INT NOT NULL,
    intel       INT NOT NULL,
    luk         INT NOT NULL,
    max_hp      INT NOT NULL,
    max_mp      INT NOT NULL,
    cur_hp      INT NOT NULL,
    cur_mp      INT NOT NULL,
    level       INT NOT NULL,
    remain_ap   INT NOT NULL,
    updated_at  TIMESTAMP
);
```

ğŸ“Œ **remain_ap í•„ìˆ˜**

* ë ˆë²¨ì—… â†’ ìŠ¤íƒ¯ ì°ëŠ” êµ¬ì¡°
* Op êµ¬í˜„ì´ ê¹”ë”í•´ì§

---

### 2-2. DB ì ‘ê·¼ ì±…ì„ ë¶„ë¦¬

ğŸ“ `db/PlayerStatRepository.h` (ì‹ ê·œ)

```cpp
class PlayerStatRepository {
public:
    CharacterStat Load(int64_t charId);
    void Update(const CharacterStat& stat);
};
```

ğŸ‘‰ DBëŠ” **Repositoryì—ì„œë§Œ**
ğŸ‘‰ Player / Handlerì—ì„œ SQL ì§ì ‘ ì¹˜ë©´ âŒ

---

## âœ… STEP 3. Playerì— Stat ì»´í¬ì§€ì…˜ ì¶”ê°€

ğŸ“ `core/Player.h`

```cpp
class Player {
public:
    CharacterStat& GetStat();
    void ApplyStat();

private:
    CharacterStat stat_;
};
```

ğŸ“Œ **í•µì‹¬**

* PlayerëŠ” Statì„ **ì†Œìœ **
* ê³„ì‚° ë¡œì§ì€ Player or StatService

---

## âœ… STEP 4. ìŠ¤íƒ¯ ê³„ì‚° ë¡œì§ ë¶„ë¦¬ (ì¤‘ìš”!)

> â€œìŠ¤íƒ¯ ê³„ì‚° = ê²Œì„ ë£°â€
> â†’ í•¸ë“¤ëŸ¬ / DB / Playerì—ì„œ í•˜ë©´ ë§í•¨

ğŸ“ `core/stat/StatCalculator.h` (ì‹ ê·œ)

```cpp
class StatCalculator {
public:
    static DerivedStat Calculate(const BaseStat& base, int level);
};
```

ì˜ˆ:

```cpp
attack = base.str * 2 + base.dex;
maxHp  = 100 + base.str * 10 + level * 5;
```

ğŸ‘‰ ë‚˜ì¤‘ì—

* ì§ì—…
* ì¥ë¹„
* ë²„í”„
  ì—¬ê¸°ë§Œ ê±´ë“œë¦¬ë©´ ë¨

---

## âœ… STEP 5. Op(í•¸ë“¤ëŸ¬) ì„¤ê³„ (2ê°œ)

---

### 5-1. ëŠ¥ë ¥ì¹˜ ì°½ ë³´ì—¬ì£¼ëŠ” Op

**Flow**

```
Client â†’ StatWindowRequest
 â†’ PlayerHandler
   â†’ Player.GetStat()
   â†’ PacketFactory
 â†’ Client
```

ğŸ“ `packet/PlayerHandler.cpp`

```cpp
void PlayerHandler::HandleStatInfo(Player& player)
{
    auto& stat = player.GetStat();
    SendStatInfoPacket(stat);
}
```

---

### 5-2. ë ˆë²¨ì—… / ìŠ¤íƒ¯ ë¶„ë°° Op

**Flow**

```
Client â†’ StatUpRequest (STR +1)
 â†’ Validate (remain_ap > 0)
 â†’ Apply BaseStat
 â†’ Recalculate DerivedStat
 â†’ DB Update
 â†’ Sync Packet
```

ğŸ“Œ ì—¬ê¸°ì„œ ì¤‘ìš”í•œ ê²ƒ

* **ì›ìì„±**
* ì‹¤íŒ¨ ì‹œ ë¡¤ë°±

---

## 2ï¸âƒ£ ì ìš©í•˜ë©´ ì¢‹ì€ ë””ìì¸ íŒ¨í„´

---

## ğŸ¯ 1. Command Pattern (ì´ë¯¸ ì“°ëŠ” êµ¬ì¡°ë‘ ì˜ ë§ìŒ)

* Op = Command
* `/stat`, `STAT_UP`

```cpp
class IStatCommand {
public:
    virtual void Execute(Player&) = 0;
};
```

ğŸ‘‰ `StatViewCommand`, `StatUpCommand`

---

## ğŸ¯ 2. Service + Repository íŒ¨í„´ (DB ë³´í˜¸)

```text
Handler
 â†’ StatService
   â†’ StatCalculator
   â†’ PlayerStatRepository
```

ğŸ“Œ **HandlerëŠ” ì–‡ê²Œ**

---

## ğŸ¯ 3. Domain Model íŒ¨í„´ (ì¤‘ìš”)

* `CharacterStat`ì€ ë‹¨ìˆœ DTO âŒ
* ìµœì†Œí•œì˜ í–‰ìœ„ í¬í•¨

```cpp
void CharacterStat::IncreaseStr() {
    if (remainAp <= 0) return;
    base.str++;
    remainAp--;
}
```

---

## ğŸ¯ 4. Observer (í›„ìˆœìœ„, í™•ì¥ìš©)

* HP ë³€ê²½ â†’ UI, ë¡œê·¸, ë°ë¯¸ì§€ ì²´í¬
* ì§€ê¸ˆì€ ì•ˆ í•´ë„ ë¨

---

## 3ï¸âƒ£ ì¶”ì²œ í´ë” êµ¬ì¡° (Channel ê¸°ì¤€)

```text
CHANNEL
â”œâ”€â”€ core
â”‚   â”œâ”€â”€ stat
â”‚   â”‚   â”œâ”€â”€ CharacterStat.h
â”‚   â”‚   â”œâ”€â”€ StatCalculator.h
â”‚   â”‚   â””â”€â”€ StatService.cpp
â”‚   â”œâ”€â”€ Player.cpp
â”‚   â””â”€â”€ ...
â”œâ”€â”€ db
â”‚   â”œâ”€â”€ PlayerStatRepository.cpp
â”‚   â””â”€â”€ ...
â”œâ”€â”€ packet
â”‚   â”œâ”€â”€ PlayerHandler.cpp
â”‚   â”œâ”€â”€ StatPacketFactory.cpp   â† ë¶„ë¦¬ ì¶”ì²œ
â”‚   â””â”€â”€ ...
```

---

## 4ï¸âƒ£ í•µì‹¬ ìš”ì•½ (ì´ê±° ê¸°ì–µí•´)

âœ” ìŠ¤íƒ¯ì€ **DBê°€ ì•„ë‹ˆë¼ ë„ë©”ì¸ ëª¨ë¸ì´ ì¤‘ì‹¬**
âœ” ê³„ì‚° ë¡œì§ì€ **í•œ ê³³ì— ëª¨ì•„ë¼ (StatCalculator)**
âœ” HandlerëŠ” **ì…ì¶œë ¥ë§Œ**
âœ” ë ˆë²¨ì—… Op = **ê°€ì¥ ìœ„í—˜í•œ íŠ¸ëœì­ì…˜ í¬ì¸íŠ¸**

---

ë‹¤ìŒ ë‹¨ê³„ë¡œ ì›í•˜ë©´ ğŸ‘‡

* **Stat íŒ¨í‚· êµ¬ì¡° ì„¤ê³„**
* **ë ˆë²¨ì—… ìˆ˜ì‹ ì¶”ì²œ**
* **ì¥ë¹„/ë²„í”„ê¹Œì§€ í™•ì¥ ê°€ëŠ¥í•œ êµ¬ì¡°**
* **Redis ìºì‹± í¬ì¸íŠ¸**

ì¤‘ì— í•˜ë‚˜ ë°”ë¡œ ë“¤ì–´ê°€ì.
ì´ê±´ ì˜ ë§Œë“¤ë©´ ChannelD í€„ë¦¬í‹° í™• ì˜¬ë¼ê°„ë‹¤ ğŸ”¥


ì¢‹ì•„, ì´ê±´ **â€œë³´ê³  ê·¸ëŒ€ë¡œ ì½”ë”© ë“¤ì–´ê°ˆ ìˆ˜ ìˆëŠ” UML ì„¸íŠ¸â€**ë¡œ ë§Œë“¤ì–´ì¤„ê²Œ.
ë§ ê·¸ëŒ€ë¡œ **ì„¤ê³„ë„** ì—­í• ì„ í•˜ê²Œë” **í˜„ì‹¤ì ì¸ íë¦„ + ë„¤ Channel êµ¬ì¡° ê¸°ì¤€**ìœ¼ë¡œ ê°„ë‹¤.

ì•„ë˜ UMLë“¤ì€ **ì„œë²„ ê´€ì (ChannelD)** ê¸°ì¤€ì´ê³ ,
ClientëŠ” â€œìš”ì²­ìâ€ ì •ë„ë¡œë§Œ ë“±ì¥ì‹œí‚¨ë‹¤.

---

# 1ï¸âƒ£ ìœ ìŠ¤ì¼€ì´ìŠ¤ ë‹¤ì´ì–´ê·¸ë¨ (Use Case)

> ğŸ‘‰ â€œëˆ„ê°€ ë¬´ì—‡ì„ í•  ìˆ˜ ìˆëŠ”ê°€â€
> ğŸ‘‰ Op ì •ì˜ìš© / ê¸°ëŠ¥ ë²”ìœ„ í•©ì˜ìš©

### ğŸ¯ í¬ì¸íŠ¸

* Actor: Player(Client)
* System: ChannelServer
* UseCase 2ê°œ

  * ëŠ¥ë ¥ì¹˜ ì¡°íšŒ
  * ëŠ¥ë ¥ì¹˜ ë¶„ë°°(ë ˆë²¨ì—…)

---

### âœ… PlantUML â€“ Use Case

```plantuml
@startuml
left to right direction

actor Player

rectangle ChannelServer {
    usecase "ëŠ¥ë ¥ì¹˜ ì°½ ì¡°íšŒ\n(View Stat)" as UC_ViewStat
    usecase "ëŠ¥ë ¥ì¹˜ ë¶„ë°°\n(Stat Up)" as UC_StatUp
}

Player --> UC_ViewStat
Player --> UC_StatUp

@enduml
```

ğŸ“Œ ì´ UMLì€

* â€œOpê°€ ëª‡ ê°œì¸ì§€â€
* â€œê¶Œí•œì€ ëˆ„ê°€ ê°–ëŠ”ì§€â€
  ì •ë¦¬í•  ë•Œ ì“°ê¸° ë”± ì¢‹ë‹¤.

---

# 2ï¸âƒ£ ì‹œí€€ìŠ¤ ë‹¤ì´ì–´ê·¸ë¨ (Sequence Diagram)

> ğŸ‘‰ **ê°€ì¥ ì¤‘ìš”**
> ğŸ‘‰ ì´ê±° ë³´ë©´ì„œ ê·¸ëŒ€ë¡œ ì½”ë“œ íë¦„ ì§œë©´ ë¨

ì•„ë˜ëŠ” **2ê°œ ì‹œí€€ìŠ¤**ë¥¼ í•œ íŒŒì¼ì— ë„£ì–´ì¤„ê²Œ.

---

## 2-1. ëŠ¥ë ¥ì¹˜ ì°½ ì¡°íšŒ ì‹œí€€ìŠ¤

### ğŸ¯ íë¦„ ìš”ì•½

```
Client
 â†’ PlayerHandler
   â†’ Player
     â†’ CharacterStat
   â†’ PacketFactory
 â†’ Client
```

---

### âœ… PlantUML â€“ Stat View Sequence

```plantuml
@startuml
participant Client
participant "PlayerHandler" as Handler
participant "Player" as Player
participant "CharacterStat" as Stat
participant "StatPacketFactory" as Packet

Client -> Handler : STAT_VIEW_REQUEST
Handler -> Player : GetStat()
Player -> Stat : getSnapshot()
Stat --> Player : StatData
Player --> Handler : StatData
Handler -> Packet : MakeStatInfo(StatData)
Packet --> Handler : StatInfoPacket
Handler --> Client : STAT_VIEW_RESPONSE
@enduml
```

ğŸ“Œ ì´ê±° ë³´ë©´ì„œ ë§Œë“¤ ì½”ë“œ:

* `HandleStatView()`
* `GetStat()`
* `MakeStatInfoPacket()`

---

## 2-2. ëŠ¥ë ¥ì¹˜ ë¶„ë°° (ë ˆë²¨ì—…) ì‹œí€€ìŠ¤

### ğŸ¯ í•µì‹¬ í¬ì¸íŠ¸

* ê²€ì¦
* ê³„ì‚°
* DB ì—…ë°ì´íŠ¸
* ê²°ê³¼ ì‘ë‹µ

---

### âœ… PlantUML â€“ Stat Up Sequence

```plantuml
@startuml
participant Client
participant "PlayerHandler" as Handler
participant "StatService" as Service
participant "CharacterStat" as Stat
participant "StatCalculator" as Calculator
participant "PlayerStatRepository" as Repo
participant "StatPacketFactory" as Packet

Client -> Handler : STAT_UP_REQUEST (STR +1)
Handler -> Service : IncreaseStat(player, STR)

Service -> Stat : canIncrease?
alt AP ë¶€ì¡±
    Service --> Handler : FAIL
    Handler --> Client : STAT_UP_FAIL
else ì •ìƒ
    Service -> Stat : increaseSTR()
    Service -> Calculator : recalcDerivedStat()
    Calculator --> Service : DerivedStat
    Service -> Repo : Update(stat)
    Repo --> Service : OK
    Service --> Handler : SUCCESS
    Handler -> Packet : MakeStatSync()
    Handler --> Client : STAT_UP_SUCCESS
end
@enduml
```

ğŸ“Œ ì´ ì‹œí€€ìŠ¤ëŠ”

* **íŠ¸ëœì­ì…˜ ê¸°ì¤€**
* **ì‹¤íŒ¨/ì„±ê³µ ë¶„ê¸°**
  ê¹Œì§€ í¬í•¨í•œ â€œì‹¤ì „ìš©â€

---

# 3ï¸âƒ£ í´ë˜ìŠ¤ ë‹¤ì´ì–´ê·¸ë¨ (Class Diagram)

> ğŸ‘‰ **êµ¬ì¡° ì´í•´ + íŒŒì¼ ë¶„ë¦¬ ê¸°ì¤€**
> ğŸ‘‰ ì´ê±° ë³´ê³  í—¤ë”ë¶€í„° ë§Œë“¤ë©´ ë¨

---

### ğŸ¯ í´ë˜ìŠ¤ ì±…ì„ ìš”ì•½

| í´ë˜ìŠ¤                  | ì±…ì„       |
| -------------------- | -------- |
| Player               | ìºë¦­í„° ë‹¨ìœ„   |
| CharacterStat        | ëŠ¥ë ¥ì¹˜ ë„ë©”ì¸  |
| StatCalculator       | ê³„ì‚° ë¡œì§    |
| StatService          | ìœ ìŠ¤ì¼€ì´ìŠ¤ ë¡œì§ |
| PlayerStatRepository | DB       |
| PlayerHandler        | Op ì²˜ë¦¬    |
| StatPacketFactory    | íŒ¨í‚· ìƒì„±    |

---

### âœ… PlantUML â€“ Class Diagram

```plantuml
@startuml

class Player {
    - CharacterStat stat
    + GetStat()
}

class CharacterStat {
    - BaseStat base
    - DerivedStat derived
    - int remainAp
    + increaseSTR()
    + increaseDEX()
}

class BaseStat {
    str
    dex
    int
    luk
}

class DerivedStat {
    maxHp
    maxMp
    attack
    moveSpeed
    jump
}

class StatCalculator {
    + Calculate(base, level) : DerivedStat
}

class StatService {
    + IncreaseStat(Player, StatType)
}

class PlayerStatRepository {
    + Load(charId)
    + Update(stat)
}

class PlayerHandler {
    + HandleStatView()
    + HandleStatUp()
}

class StatPacketFactory {
    + MakeStatInfo()
    + MakeStatSync()
}

Player "1" *-- "1" CharacterStat
CharacterStat *-- BaseStat
CharacterStat *-- DerivedStat

StatService --> StatCalculator
StatService --> PlayerStatRepository
PlayerHandler --> StatService
PlayerHandler --> StatPacketFactory
PlayerHandler --> Player

@enduml
```

ğŸ“Œ ì´ ë‹¤ì´ì–´ê·¸ë¨ ê¸°ì¤€ìœ¼ë¡œ

* í´ë” ë‚˜ëˆ„ê¸°
* í—¤ë” ë§Œë“¤ê¸°
* cpp êµ¬í˜„
  ë“¤ì–´ê°€ë©´ **ì ˆëŒ€ ê¸¸ ì•ˆ ìƒìŒ**

---

# ğŸ”¥ ì •ë¦¬

ì´ 3ê°œ UML ì—­í• ì€ ì´ë ‡ê²Œ ì¨ë¨¹ì–´ë¼:

1ï¸âƒ£ **Use Case**
â†’ â€œOp ëª‡ ê°œì¸ì§€ / ë²”ìœ„ í™•ì •â€

2ï¸âƒ£ **Sequence**
â†’ â€œHandler / Service / Repo ì½”ë“œ ìˆœì„œ ê·¸ëŒ€ë¡œâ€

3ï¸âƒ£ **Class Diagram**
â†’ â€œíŒŒì¼ êµ¬ì¡° + ì±…ì„ ë¶„ë¦¬ ê¸°ì¤€â€

---

ë‹¤ìŒìœ¼ë¡œ ë°”ë¡œ ê°ˆ ìˆ˜ ìˆëŠ” ê²ƒ ğŸ‘‡

* ğŸ“¦ **íŒ¨í‚· êµ¬ì¡° UML**
* ğŸ§® **ìŠ¤íƒ¯ ìˆ˜ì‹ ì •ë¦¬ + í‘œ**
* ğŸ§± **ì¥ë¹„/ë²„í”„ í™•ì¥ UML**
* ğŸ—„ï¸ **Redis ìºì‹± ì‹œí€€ìŠ¤**

ğŸ‘‰ ë‹¤ìŒ ë­ í• ì§€ ë”± í•˜ë‚˜ë§Œ ê³¨ë¼.


ì¢‹ì•„ ğŸ‘
ì´ê±´ **â€œDB í…Œì´ë¸” ë³´ë©´ì„œ Repository ì½”ë“œ ë°”ë¡œ ì¹  ìˆ˜ ìˆëŠ” ìˆ˜ì¤€â€**ìœ¼ë¡œ ë§Œë“¤ì–´ì¤„ê²Œ.
**ERD + ì»¬ëŸ¼ ì˜ë¯¸ê°€ í•œëˆˆì— ë³´ì´ê²Œ** ì„¤ê³„í•œë‹¤.

ì•„ë˜ UMLì€ **ChannelD ê¸°ì¤€ / MySQL ê¸°ì¤€ / char_id ì¤‘ì‹¬ ì„¤ê³„**ì•¼.

---

# ğŸ“Š Character Stat DB ì„¤ê³„ (ER Diagram)

## ğŸ¯ ì„¤ê³„ ì˜ë„ ìš”ì•½

* **char_id = PK**
* Player ê¸°ë³¸ ì •ë³´ í…Œì´ë¸”ê³¼ **1:1 ê´€ê³„**
* ìŠ¤íƒ¯ ê³„ì‚°ìš© ì»¬ëŸ¼ vs ëŸ°íƒ€ì„ ì»¬ëŸ¼ ë¶„ë¦¬
* ë ˆë²¨ì—… & ìŠ¤íƒ¯ ë¶„ë°°ë¥¼ ê³ ë ¤í•œ êµ¬ì¡°

---

## âœ… PlantUML â€“ DB ER Diagram

```plantuml
@startuml
entity character {
    + char_id : BIGINT <<PK>>
    ---
    account_id : BIGINT
    name : VARCHAR
    level : INT
}

entity character_stat {
    + char_id : BIGINT <<PK, FK>>
    ---
    str : INT
    dex : INT
    intel : INT
    luk : INT

    max_hp : INT
    max_mp : INT
    cur_hp : INT
    cur_mp : INT

    remain_ap : INT
    updated_at : TIMESTAMP
}

character ||--|| character_stat : "1:1"

@enduml
```

---

## ğŸ§  ì»¬ëŸ¼ ì˜ë¯¸ ì •ë¦¬ (ì´í•´ìš©)

### ğŸ”¹ Base Stat (ì§ì ‘ ì¦ê°€)

```text
str / dex / intel / luk
```

* ë ˆë²¨ì—… ì‹œ ì¦ê°€ ëŒ€ìƒ
* í´ë¼ì´ì–¸íŠ¸ì—ì„œ ì§ì ‘ ì¡°ì‘ âŒ (Op í†µí•´ì„œë§Œ)

---

### ğŸ”¹ Derived Stat (ê³„ì‚° ê²°ê³¼)

```text
max_hp / max_mp
```

* base stat + level ê¸°ë°˜ ê³„ì‚° ê²°ê³¼
* DB ì €ì¥ â†’ ì¬ì ‘ì† ì‹œ ë³µì›ìš©

---

### ğŸ”¹ Runtime Stat (ì‹¤ì‹œê°„ ê°’)

```text
cur_hp / cur_mp
```

* ì „íˆ¬ / íšŒë³µì— ë”°ë¼ ìˆ˜ì‹œ ë³€ê²½
* Redis ìºì‹± ëŒ€ìƒ 1ìˆœìœ„

---

### ğŸ”¹ remain_ap

```text
remain_ap
```

* ë ˆë²¨ì—… ì‹œ ì¦ê°€
* ìŠ¤íƒ¯ ë¶„ë°° ì‹œ ê°ì†Œ
* **StatUp Op ê²€ì¦ í•µì‹¬ ì»¬ëŸ¼**

---

## ğŸ§± Repository ì½”ë“œì™€ 1:1 ë§¤í•‘ ì˜ˆì‹œ

ğŸ“ `PlayerStatRepository.cpp`

```cpp
SELECT
    str, dex, intel, luk,
    max_hp, max_mp,
    cur_hp, cur_mp,
    remain_ap
FROM character_stat
WHERE char_id = ?;
```

```cpp
UPDATE character_stat
SET
    str = ?, dex = ?, intel = ?, luk = ?,
    max_hp = ?, max_mp = ?,
    cur_hp = ?, cur_mp = ?,
    remain_ap = ?,
    updated_at = NOW()
WHERE char_id = ?;
```

ğŸ‘‰ UML ë³´ê³  ì»¬ëŸ¼ í•˜ë‚˜ë¼ë„ í—·ê°ˆë¦¬ë©´ âŒ
ğŸ‘‰ ì§€ê¸ˆ êµ¬ì¡°ëŠ” **ì½”ë“œ-DB-ë„ë©”ì¸ 3ê°œê°€ ì •í™•íˆ ê²¹ì¹¨**

---

## ğŸ”¥ í™•ì¥ ëŒ€ë¹„ (ì§€ê¸ˆì€ ì•ˆ ë§Œë“¤ì–´ë„ ë˜ëŠ” ê²ƒ)

ì¶”í›„ í™•ì¥ ì‹œ **ì ˆëŒ€ character_statì— ì¶”ê°€í•˜ì§€ ë§ ê²ƒ**:

* ì¥ë¹„ ë³´ì •
* ë²„í”„
* íŒ¨ì‹œë¸Œ ìŠ¤í‚¬

ğŸ‘‰ ì´ê±´ ë³„ë„ í…Œì´ë¸”

```text
character_equip_stat
character_buff_stat
```

---

## âœ… ìµœì¢… ì •ë¦¬

âœ” ERD = DB ì„¤ê³„ + Repository ì„¤ê³„ ê¸°ì¤€
âœ” char_id 1:1 êµ¬ì¡° â†’ Player ë¡œë”© ë‹¨ìˆœ
âœ” remain_ap í¬í•¨ â†’ ë ˆë²¨ì—… Op ì•ˆì •
âœ” Redis ìºì‹±/ë¹„ë™ê¸° ì €ì¥ì—ë„ ì í•©

---

ë‹¤ìŒìœ¼ë¡œ ì´ì–´ê°€ê¸° ì¢‹ë‹¤ ğŸ‘‡

* ğŸ§© **Redis ìºì‹± êµ¬ì¡° ERD**
* ğŸ—„ï¸ **ì¥ë¹„ ìŠ¤íƒ¯ í…Œì´ë¸” ERD**
* âš”ï¸ **ì „íˆ¬ ë°ë¯¸ì§€ ê³„ì‚° ì‹œí€€ìŠ¤**
* ğŸ”„ **Stat ë³€ê²½ ì‹œ DB/Redis ë™ê¸°í™” UML**

ì›í•˜ëŠ” ê±° í•˜ë‚˜ë§Œ ì½• ì§‘ì–´.
